---
- name: Create directory structure 4 plugins
  when: ansible_system == 'Linux'
  become: yes
  file:
    path: '{{ dokuwiki_fs_dir }}/lib/plugins/{{ item.dokuwiki_plugin_dir_name }}'
    owner: '{{ dokuwiki_user_web_server }}'
    group: '{{ dokuwiki_group_web_server }}'
    mode: '{{ dokuwiki_chmod }}'
    state: directory
  with_items:
    - "{{ dokuwiki_plugin_collection }}"

- name: Install plugins 4 DokuWiki
  when: ansible_system == 'Linux'
  become: yes
  unarchive:
    src: '{{ item.dokuwiki_plugin_url }}'
    dest: '{{ dokuwiki_fs_dir }}/lib/plugins/{{ item.dokuwiki_plugin_dir_name }}'
    remote_src: yes
    owner: '{{ dokuwiki_user_web_server }}'
    group: '{{ dokuwiki_group_web_server }}'
    mode: '{{ dokuwiki_chmod }}'
    extra_opts:
      - --strip-components={{ item.dokuwiki_plugin_skip_directory_level }}
  with_items:
    - "{{ dokuwiki_plugin_collection }}"

# https://www.dokuwiki.org/plugin:filelist
# https://www.dokuwiki.org/plugin:var
# https://www.dokuwiki.org/plugin:keyboard
# https://www.dokuwiki.org/plugin:dw2pdf
# https://www.dokuwiki.org/plugin:odt
# https://www.dokuwiki.org/plugin:feed
# https://www.dokuwiki.org/plugin:comment
# https://www.dokuwiki.org/plugin:discussion
# https://www.dokuwiki.org/plugin:text
# https://www.dokuwiki.org/plugin:bookcreator
# https://www.dokuwiki.org/plugin:csv
# https://www.dokuwiki.org/plugin:drawio
# https://www.dokuwiki.org/plugin:mdpage
# https://www.dokuwiki.org/plugin:gallery
# https://www.dokuwiki.org/plugin:goto
# https://www.dokuwiki.org/plugin:searchindex
# https://www.dokuwiki.org/plugin:upgrade
# https://www.dokuwiki.org/plugin:vshare
# TODO https://www.dokuwiki.org/plugin:webdav
# Дождаться поддержки в Hogfather https://www.dokuwiki.org/plugin:indexmenu